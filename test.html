#target photoshop

// 新しいドキュメントを作成する関数
function createDummyImage(width, height) {
    var docRef = app.documents.add(width, height, 72, "DummyImage", NewDocumentMode.RGB);

    // 背景色を設定
    var bgColor = new SolidColor();
    bgColor.rgb.hexValue = "cccccc"; // 背景色 #ccc
    docRef.selection.selectAll();
    docRef.selection.fill(bgColor);
    docRef.selection.deselect();

    // テキストレイヤーを追加
    var textColor = new SolidColor();
    textColor.rgb.hexValue = "666666"; // テキスト色 #666
    var textLayer = docRef.artLayers.add();
    textLayer.kind = LayerKind.TEXT;
    textLayer.textItem.contents = "Dummy";
    textLayer.textItem.position = [width / 2, height / 2]; // 中央に配置
    textLayer.textItem.color = textColor;
    textLayer.textItem.size = 24;
    textLayer.textItem.justification = Justification.CENTER;
    textLayer.textItem.font = "Arial-BoldMT"; // 太字フォントを指定
    textLayer.textItem.kind = TextType.POINTTEXT;

    // テキストを中央に配置（修正）
    textLayer.textItem.position = [width / 2, height / 2 + textLayer.textItem.size / 2];
}

// ダイアログボックスを表示してユーザー入力を受け取る関数
function getUserInput() {
    var dialog = new Window("dialog", "ダミー画像作成");
    dialog.orientation = "column";

    // 幅を広げるための設定
    dialog.alignChildren = "left";
    dialog.margins = 20;
    dialog.spacing = 10;

    var widthGroup = dialog.add("group");
    widthGroup.add("statictext", undefined, "幅 (px):");
    var widthInput = widthGroup.add("edittext", undefined, "800");
    widthInput.characters = 20;

    var heightGroup = dialog.add("group");
    heightGroup.add("statictext", undefined, "高さ (px):");
    var heightInput = heightGroup.add("edittext", undefined, "600");
    heightInput.characters = 20;

    var buttonGroup = dialog.add("group");
    buttonGroup.alignment = "center";
    buttonGroup.add("button", undefined, "OK", {name: "ok"});
    buttonGroup.add("button", undefined, "キャンセル", {name: "cancel"});

    if (dialog.show() == 1) {
        return {
            width: parseInt(widthInput.text),
            height: parseInt(heightInput.text)
        };
    } else {
        return null;
    }
}

// ユーザー入力を受け取り、ダミー画像を生成する
var userInput = getUserInput();
if (userInput) {
    createDummyImage(userInput.width, userInput.height);
}
