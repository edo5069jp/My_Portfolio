#target photoshop

// 新しいドキュメントを作成する関数
function createDummyImage(width, height) {
    var docRef = app.documents.add(width, height, 72, "DummyImage", NewDocumentMode.RGB);

    // 背景色を設定
    var bgColor = new SolidColor();
    bgColor.rgb.hexValue = "cccccc"; // 背景色 #ccc
    docRef.selection.selectAll();
    docRef.selection.fill(bgColor);
    docRef.selection.deselect();

    // テキストレイヤーを追加
    var textColor = new SolidColor();
    textColor.rgb.hexValue = "333333"; // テキスト色 #333
    var textLayer = docRef.artLayers.add();
    textLayer.kind = LayerKind.TEXT;
    textLayer.textItem.contents = "Dummy";
    textLayer.textItem.position = [width / 2, height / 2]; // 中央に配置
    textLayer.textItem.color = textColor;
    textLayer.textItem.size = 24;
    textLayer.textItem.justification = Justification.CENTER;
    textLayer.textItem.kind = TextType.POINTTEXT;

    // テキストを中央に配置（修正）
    textLayer.textItem.position = [width / 2, height / 2 + textLayer.textItem.size / 2];
}

// ダイアログボックスを表示してユーザー入力を受け取る関数
function getUserInput() {
    var dialog = new Window("dialog", "ダミー画像作成");
    dialog.add("statictext", undefined, "幅 (px):");
    var widthInput = dialog.add("edittext", undefined, "800");
    dialog.add("statictext", undefined, "高さ (px):");
    var heightInput = dialog.add("edittext", undefined, "600");
    widthInput.characters = 10;
    heightInput.characters = 10;

    dialog.add("button", undefined, "OK", {name: "ok"});
    dialog.add("button", undefined, "キャンセル", {name: "cancel"});

    if (dialog.show() == 1) {
        return {
            width: parseInt(widthInput.text),
            height: parseInt(heightInput.text)
        };
    } else {
        return null;
    }
}

// ユーザー入力を受け取り、ダミー画像を生成する
var userInput = getUserInput();
if (userInput) {
    createDummyImage(userInput.width, userInput.height);
}
