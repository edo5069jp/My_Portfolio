#target photoshop

// 新しいドキュメントを作成する関数
function createDummyImage(width, height) {
    var docRef = app.documents.add(width, height, 72, "DummyImage", NewDocumentMode.RGB);
    var newLayer = docRef.artLayers.add();
    newLayer.name = "Background";
    docRef.selection.selectAll();
    docRef.selection.fill(app.foregroundColor);
    docRef.selection.deselect();
}

// ダイアログボックスを表示してユーザー入力を受け取る関数
function getUserInput() {
    var dialog = new Window("dialog", "ダミー画像作成");
    dialog.add("statictext", undefined, "幅 (px):");
    var widthInput = dialog.add("edittext", undefined, "800");
    dialog.add("statictext", undefined, "高さ (px):");
    var heightInput = dialog.add("edittext", undefined, "600");
    widthInput.characters = 10;
    heightInput.characters = 10;

    dialog.add("button", undefined, "OK", {name: "ok"});
    dialog.add("button", undefined, "キャンセル", {name: "cancel"});

    if (dialog.show() == 1) {
        return {
            width: parseInt(widthInput.text),
            height: parseInt(heightInput.text)
        };
    } else {
        return null;
    }
}

// ユーザー入力を受け取り、ダミー画像を生成する
var userInput = getUserInput();
if (userInput) {
    createDummyImage(userInput.width, userInput.height);
}
